@model Proestimator.ViewModel.Profiles.TaxesVM
@{
    ViewBag.Title = Proestimator.Resources.ProStrings.Taxes;
}

<style>
    @@media screen and (max-width:700px) {
        #smEstimateNavRow {
            border: 1px solid #349ad8;
            background-color: #f5f9fb;
            max-width: 100%;
            padding-right: 30px;
        }

        #estimateNavigation {
            margin-top: 15px;
        }
    }
</style>
<script>

    $(document).ready(function () {
        $("#TaxLaborAndPartsSeparately").change(function () {
            RefreshSeparate();
        });

        RefreshSeparate();
    });

    function RefreshSeparate()
    {
        if ($("#TaxLaborAndPartsSeparately").is(":checked"))
        {
            $("#labelTaxRate").text("Labor Tax Rate");
            $(".separate-fields").show();
            $(".together-fields").hide();
        }
        else
        {
            $("#labelTaxRate").text("@Proestimator.Resources.ProStrings.TaxRate");
            $(".separate-fields").hide();
            $(".together-fields").show();
        }
    }

</script>

<div id="workDesk" class="page-container">

    @if (!Model.ProfileIsValid)
    {
        <h2>@Proestimator.Resources.ProStrings.InvalidProfile</h2>
    }
    else
    {
        using (Html.BeginForm("Taxes", "RateProfile", FormMethod.Post, new { @class = "container" }))
        {
            @Html.Partial("RateProfileTopMenu", Model.ProfileID)

            @Html.HiddenFor(model => model.LoginID)
            @Html.HiddenFor(model => model.ProfileID)
            @Html.HiddenFor(model => model.ProfileName)
            @Html.HiddenFor(model => model.Description)
            @Html.HiddenFor(model => model.EstimateID)

            Html.EnableClientValidation(false);

            <input type="hidden" id="redirectData" name="redirectDataField" />

            <div class="tabcontent container">

                <div id="formHeader">

                    <div id="profileName" class="container rate-ProfileName">
                        <label>
                            <b>@Proestimator.Resources.ProStrings.RateProfile_ProfileName: @Model.ProfileName</b>

                            <p class="profile-message">
                                @if (Model.IsGlobalProfile)
                                {
                                    @Proestimator.Resources.ProStrings.ProfileMessage_Global
                                }
                                else
                                {
                                    @Proestimator.Resources.ProStrings.ProfileMessage_Estimate
                                }
                            </p>
                        </label>
                    </div>

                    @* The previous and next buttons *@
                    <div id="container">
                        <div class="half-container">
                            <a class="button nav-btn" href="@("javascript:SubmitAndRedirect('/" + ViewBag.UserID + "/print-options/" + Model.ProfileID + "');")">&lt;&lt; @Proestimator.Resources.ProStrings.PageTitle_Printing</a>
                        </div>

                        <div class="half-container">
                            <a class="button nav-btn" href="@("javascript:SubmitAndRedirect('/" + ViewBag.UserID + "/preset-charges/" + Model.ProfileID + "');")">@Proestimator.Resources.ProStrings.PageTitle_PresetCharges >></a>
                        </div>
                    </div>
                </div>

                <div id="lgRow1" class="container">

                    @* The Save button above the forms *@
                    @if (Model.EstimateID > 0 && Model.EstimateIsLocked)
                    {
                        <p class="error-message">@Proestimator.Resources.ProStrings.Estimate_Message_LockedNoEdit</p>
                    }

                    <div class="container center" style="padding-bottom: 20px;">
                        @if (!Model.EstimateIsLocked)
                        {
                            <input id="submitButton" class="button nav-btn" type="submit" value="@Proestimator.Resources.ProStrings.Save" />
                        }
                    </div>

                    <div id="overlapFieldSetContainer" class="half-container">

                        <fieldset id="customerFieldSet">

                            <legend><span class="number">1</span>@Proestimator.Resources.ProStrings.SalesTax</legend>

                            <div class="field-wrapper">
                                <label id="labelTaxRate" class="inputLabel field-label">@Proestimator.Resources.ProStrings.TaxRate</label>
                                <div class="field-control">
                                    @Html.TextBoxFor(model => model.TaxRate, new { autocomplete = "off" })
                                </div>
                            </div>

                            <div class="field-wrapper together-fields">
                                <label class="inputLabel field-label">
                                    @Proestimator.Resources.ProStrings.RateProfile_AdditionalTaxLevels
                                    <br>@Proestimator.Resources.ProStrings.RateProfile_2ndTaxBegins
                                </label>
                                <div class="field-control">
                                    @Html.TextBoxFor(model => model.SecondTaxRateStart, new { autocomplete = "off" })
                                </div>
                            </div>

                            <div class="field-wrapper together-fields">
                                <label class="inputLabel field-label">@Proestimator.Resources.ProStrings.RateProfile_2ndTaxRate</label>
                                <div class="field-control">
                                    @Html.TextBoxFor(model => model.SecondTaxRate, new { autocomplete = "off" })
                                </div>
                            </div>

                            <div class="field-wrapper">
                                <label class="inputLabel field-label">&nbsp;</label>
                                <div class="field-control">
                                    <label>@Html.CheckBoxFor(model => model.TaxLaborAndPartsSeparately) @Proestimator.Resources.ProStrings.TaxLaborPartsSeparately</label>
                                </div>
                            </div>

                            <div class="field-wrapper separate-fields">
                                <label class="inputLabel field-label">@Proestimator.Resources.ProStrings.PartsTaxRate</label>
                                <div class="field-control">
                                    @Html.TextBoxFor(model => model.PartsTaxRate, new { autocomplete = "off" })
                                </div>
                            </div>
                        </fieldset>
                    </div>

                    <div id="overlapFieldSetContainer" class="half-container">

                        <fieldset id="customerFieldSet">

                            <fieldset id="customerFieldSet">
                                <legend><span class="number">2</span>@Proestimator.Resources.ProStrings.Other</legend>

                                <div class="field-wrapper">
                                    <label class="inputLabel field-label">@Proestimator.Resources.ProStrings.Tax_TextForLKQ:</label>
                                    <div class="field-control">
                                        @Html.TextBoxFor(model => model.LKQText)
                                    </div>
                                </div>

                                <div class="field-wrapper">
                                    <label class="inputLabel field-label">@Proestimator.Resources.ProStrings.Tax_TotalLossPercentage:</label>
                                    <div class="field-control">
                                        @Html.TextBoxFor(model => model.TotalLossPerc)
                                    </div>
                                </div>
                            </fieldset>

                        </fieldset>
                    </div>
                </div>

                <div class="container">
                    <div class="half-container">
                        <fieldset id="customerFieldSet">
                            <legend><span class="number">3</span>@Proestimator.Resources.ProStrings.Tax_AutomaticCharges</legend>

                            <div class="field-wrapper">
                                <div class="field-control">
                                    @Html.CheckBoxFor(model => model.ChargeForAimingHeadlights) @Proestimator.Resources.ProStrings.Tax_AimHeadlightsRequired
                                </div>
                            </div>

                            <div class="field-wrapper">
                                <div class="field-control">
                                    @Html.CheckBoxFor(model => model.ChargeForPowerUnits) @Proestimator.Resources.ProStrings.Tax_PowerUnitsRequired
                                </div>
                            </div>

                            <div class="field-wrapper">
                                <div class="field-control">
                                    @Html.CheckBoxFor(model => model.ChargeForRefrigRecovery) @Proestimator.Resources.ProStrings.Tax_RefrigerantRecoverRequired
                                </div>
                            </div>

                            <div class="field-wrapper">
                                <div class="field-control">
                                    @Html.CheckBoxFor(model => model.SuppressAddRelatedPrompt) @Proestimator.Resources.ProStrings.Tax_SuppressAddRelatedPrompt
                                </div>
                            </div>
                        </fieldset>
                    </div>
                </div>

            </div>

            <div id="container">
                <div class="half-container">
                    <a class="button nav-btn" href="@("javascript:SubmitAndRedirect('/" + ViewBag.UserID + "/print-options/" + Model.ProfileID + "');")">@Proestimator.Resources.ProStrings.PreviousButton</a>
                </div>

                <div class="half-container">
                    <a class="button nav-btn" href="@("javascript:SubmitAndRedirect('/" + ViewBag.UserID + "/preset-charges/" + Model.ProfileID + "');")">@Proestimator.Resources.ProStrings.NextButton</a>
                </div>
            </div>
        }
    }
</div> 